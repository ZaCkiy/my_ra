<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MyRa</title><link rel="icon" href="https://img.icons8.com/ios-filled/50/ffffff/broom.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg-color: #121212;
            --card-color: #1e1e1e;
            --text-color: #e0e0e0;
            --accent-color: #bb86fc;
            --success-color: #03dac6;
            --green-besi: #2e7d32; 
            --danger-color: #cf6679;
            --input-bg: #2c2c2c;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--bg-color); color: var(--text-color); -webkit-tap-highlight-color: transparent; padding-bottom: 40px;}
     
        /* Watermark Style */
        .watermark {
            position: fixed;
            bottom: 10px;
            left: 10px;
            font-size: 12px;
            color: rgba(224, 224, 224, 0.4); /* Transparansi sekitar 60% (alpha 0.4) */
            z-index: 999; /* Agar selalu di atas elemen lain */
            pointer-events: none; /* Agar tidak mengganggu klik pada tombol lain */
            font-weight: 300;
            letter-spacing: 1px;
        }
        /* Utility */
        .hidden { display: none !important; }
        .container { padding: 20px; max-width: 600px; margin: 0 auto; }
        h1, h2, h3, h4 { margin-bottom: 10px; }
        .btn { width: 100%; padding: 12px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-family: 'Poppins'; margin-top: 10px; transition: 0.2s;}
        .btn-primary { background-color: var(--accent-color); color: #000; }
        .btn-success { background-color: var(--success-color); color: #000; }
        .btn-danger { background-color: var(--danger-color); color: #fff; }
        .icon { margin-right: 8px; }

        /* Login Page */
        #login-page { display: flex; flex-direction: column; justify-content: center; height: 100vh; text-align: center; }
        input[type="text"], input[type="number"], textarea { width: 100%; padding: 12px; background: var(--input-bg); border: 1px solid #444; color: #fff; border-radius: 8px; margin-bottom: 10px; font-family: 'Poppins'; }
        
        /* Dashboard Header */
        .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .header-stats { display: flex; justify-content: space-between; background: var(--card-color); padding: 15px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        .stat-box { text-align: center; font-size: 0.8rem; }
        .stat-box span { display: block; font-size: 1.2rem; font-weight: bold; color: var(--accent-color); }
        
        .btn-delete {
            background: none;
            border: 1px solid var(--danger-color);
            color: var(--danger-color);
            padding: 5px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
        }
        .btn-delete:active {
            background: var(--danger-color);
            color: #fff;
              }
        
        /* Room List */
        .room-card { background: var(--card-color); padding: 15px; border-radius: 10px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; border-left: 5px solid var(--accent-color); }
        .room-card.completed { border-left: 5px solid var(--green-besi); background: #1b2e1b; } 
        .room-number { font-size: 1.2rem; font-weight: bold; }
        .room-status { font-size: 0.8rem; padding: 4px 8px; background: #333; border-radius: 4px; color: var(--accent-color); }
        
        /* Modal */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 100; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px; }
        .status-grid, .number-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 100%; }
        .grid-btn { padding: 15px; background: var(--card-color); border: 1px solid #444; color: #fff; border-radius: 8px; font-weight: bold; }

        .menu-list { width: 100%; max-width: 300px; background: var(--card-color); border-radius: 12px; padding: 20px; text-align: center; }
        .menu-item { display: block; width: 100%; padding: 15px; border-bottom: 1px solid #333; cursor: pointer; }

        /* Detail Page */
        .detail-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .time-btn { background: #333; color: var(--accent-color); border: 1px solid var(--accent-color); margin-bottom: 10px; }
        .time-btn.active { background: var(--accent-color); color: #000; }
        .status2-btn { background: #2c2c2c; color: #fff; border: 1px solid #555; margin-bottom: 15px; }
        
        .item-row { background: var(--card-color); padding: 12px; border-radius: 8px; display: flex; justify-content: space-between; cursor: pointer; margin-bottom: 8px;}
        .item-qty { font-weight: bold; color: var(--success-color); }

        /* Summary */
        .summary-table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.8rem; }
        .summary-table th, .summary-table td { border: 1px solid #444; padding: 8px; text-align: left; }
        .summary-table th { background: #333; }

        @media print {
            .no-print { display: none !important; }
            body { background: #fff; color: #000; }
            #summary-page { display: block !important; }
            .summary-table th, .summary-table td { border: 1px solid #000; color: #000; }
        }
    </style>
</head>
<body>

    <div id="login-page" class="container">
        <h1><i class="fa-solid fa-broom icon"></i>MyRA</h1>
        <p style="margin-bottom: 20px; color: #aaa;" data-lang="app_desc">Room Attendant Worksheet</p>
        <input type="text" id="username" placeholder="Name / ID">
        <button class="btn btn-primary" onclick="login()" data-lang="btn_login">Start Shift</button>
    </div>

    <div id="dashboard-page" class="container hidden">
        <div class="header-top">
            <h3><span data-lang="hi">Hi</span>, <span id="display-name">User</span></h3>
            <div onclick="openUserMenu()" style="cursor: pointer; padding: 8px; background: #333; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">
                <i class="fa-solid fa-user" style="font-size: 1.5rem;"></i>
            </div>
        </div>

        <div class="header-stats">
            <div class="stat-box"><span id="total-credits">0</span><i class="fa-solid fa-coins"></i> <span data-lang="credit">Credit</span></div>
            <div class="stat-box"><span id="total-progress">0</span><i class="fa-solid fa-spinner"></i> <span data-lang="progress">Progress</span></div>
            <div class="stat-box"><span id="total-done" style="color: var(--success-color);">0</span><i class="fa-solid fa-check-circle"></i> <span data-lang="done">Done</span></div>
        </div>

        <div class="input-section" style="background: var(--card-color); padding: 15px; border-radius: 12px; margin-bottom: 20px;">
            <h4><i class="fa-solid fa-door-open icon"></i><span data-lang="input_room">New Room Input</span></h4>
            <div style="display: flex; gap: 10px; margin-top: 10px;">
                <input type="number" id="new-room-number" placeholder="Room No." style="margin:0; width: 60%;">
                <button class="btn btn-primary" style="margin:0; width: 40%;" onclick="openStatusModal('initial')">Status 1</button>
            </div>
        </div>

        <div id="room-list"></div>

        <div class="input-section" style="margin-top: 30px; background: var(--card-color); padding: 15px; border-radius: 10px;">
            <h4 data-lang="daily_act">Daily Activities</h4>
            <label style="font-size: 0.8rem; color:#aaa;">Morning (07:00 - 08:00)</label>
            <textarea id="act-morning" rows="2"></textarea>
            <label style="font-size: 0.8rem; color:#aaa;">Afternoon (End Shift)</label>
            <textarea id="act-afternoon" rows="2"></textarea>
        </div>

        <button class="btn btn-danger" style="margin-top: 20px;" onclick="showSummary()">
            <i class="fa-solid fa-file-invoice icon"></i> <span data-lang="btn_end">End Shift & Summary</span>
        </button>
    </div>

    <div id="detail-page" class="container hidden">
        <div class="detail-header">
            <button onclick="goBack()" style="background:none; border:none; color:white; font-size:1.2rem;">
                <i class="fa-solid fa-arrow-left"></i>
            </button>
            
            <h2 id="detail-room-number" style="margin-bottom:0;">Room</h2>
            
            <button class="btn-delete" onclick="deleteRoom()">
                <i class="fa-solid fa-trash-can"></i> Delete
            </button>
        </div>
        
        <div style="text-align: center; margin-bottom: 20px;">
            <span id="detail-status-1" class="room-status"></span>
        </div>
        
        <button id="btn-time-in" class="btn time-btn" onclick="setTime('in')">
            <i class="fa-regular fa-clock icon"></i> Time In <span id="display-time-in">--:--</span>
        </button>

        <button id="btn-status-2" class="btn status2-btn" onclick="openStatusModal('status2')">
            <i class="fa-solid fa-rotate icon"></i> <span id="display-status-2">Select Status 2</span>
        </button>

        <h4 style="margin: 15px 0 10px 0;"><i class="fa-solid fa-list-check icon"></i>Amenities & Linen</h4>
        <div id="amenities-list"></div>

        <h4 style="margin: 20px 0 10px 0;"><i class="fa-solid fa-sticky-note icon"></i><span data-lang="note">Note</span></h4>
        <textarea id="room-note" rows="3"></textarea>

        <button id="btn-time-out" class="btn time-btn" onclick="setTime('out')">
            <i class="fa-solid fa-clock icon"></i> Time Out <span id="display-time-out">--:--</span>
        </button>

        <button class="btn btn-success" onclick="openStatusModal('final')">
            <i class="fa-solid fa-check icon"></i> <span data-lang="btn_final">Status 3 (Done)</span>
        </button>
    </div>

    <div id="summary-page" class="container hidden">
        <div class="no-print" style="display: flex; justify-content: space-between; margin-bottom: 20px;">
            <button onclick="goBackToDashboard()" style="background:none; border:none; color:white;"><i class="fa-solid fa-arrow-left"></i> <span data-lang="back">Back</span></button>
            <button onclick="printReport()" style="background:none; border:none; color:var(--accent-color);"><i class="fa-solid fa-print"></i> PDF</button>
        </div>
        <div id="summary-content">
            <h2 style="text-align: center; border-bottom: 1px solid #444;" data-lang="report_title">Daily Report</h2>
            <p><strong>Name:</strong> <span id="sum-name"></span></p>
            <p><strong>Date:</strong> <span id="sum-date"></span></p>
            <table class="summary-table">
                <thead>
                    <tr><th>Room</th><th>Time</th><th>Status</th><th>Items</th></tr>
                </thead>
                <tbody id="summary-body"></tbody>
            </table>
            <div style="margin-top: 20px; text-align: right;">
                <p><span data-lang="total_credit">Total Credit</span>: <strong id="sum-credit">0</strong></p>
                <p><span data-lang="total_done">Total Done</span>: <strong id="sum-done">0</strong></p>
            </div>
            <div style="margin-top:20px; border-top:1px solid #444; padding-top:10px;">
                <h4>Daily Activities</h4>
                <p><strong>Morning:</strong> <span id="sum-morning"></span></p>
                <p><strong>Afternoon:</strong> <span id="sum-afternoon"></span></p>
            </div>
        </div>
    </div>

    <div id="user-menu-modal" class="modal hidden" onclick="closeModal()">
        <div class="menu-list" onclick="event.stopPropagation()">
            <div class="menu-item" onclick="switchLanguage()">
                <i class="fa-solid fa-language icon"></i> <span id="lang-label">Switch to Indonesia</span>
            </div>
            <div class="menu-item" style="color:var(--danger-color)" onclick="logout()">
                <i class="fa-solid fa-right-from-bracket icon"></i> Logout & Reset Data
            </div>
        </div>
    </div>

    <div id="status-modal" class="modal hidden">
        <h3 data-lang="select_status">Select Status</h3>
        <div id="status-options" class="status-grid"></div>
        <button class="btn btn-danger" onclick="closeModal()" data-lang="cancel">Cancel</button>
    </div>

    <div id="qty-modal" class="modal hidden">
        <h3>Qty</h3>
        <div class="number-grid">
            <script>
                for(let i=1; i<=10; i++) document.write(`<button class="grid-btn" onclick="selectQty(${i})">${i}</button>`);
            </script>
            <button class="grid-btn" style="background:#555" onclick="selectQty(0)">0</button>
        </div>
    </div>

    <script>
        const itemsList = ["Sheet Twin", "Sheet King", "Duve Twin", "Duve King", "Pillow Case", "Bath Towel", "Hand Towel", "Bath Mat", "Soap", "Shampoo", "Dental Kit", "Shower Cap", "Sanitary Bag", "Cotton Bud", "Comb", "Tissue Roll", "Slipper", "Laundry Bag", "Laundry List", "Memo Pad", "Pencil", "White Sugar", "Brown Sugar", "Creamer", "Coffee", "Tea", "Mineral Water", "Stirrer", "Glass Coaster"];
        // Status sesuai permintaan
        const allStatuses = ["VD", "VC", "OD", "OC", "ED", "NS", "SO", "VCU", "SR"];

        let currentUser = localStorage.getItem('myra_user') || "";
        let rooms = JSON.parse(localStorage.getItem('myra_rooms')) || [];
        let activities = JSON.parse(localStorage.getItem('myra_activities')) || { morning: "", afternoon: "" };
        let currentLang = localStorage.getItem('myra_lang') || "en";
        let currentRoomId = null, currentStatusType = "", currentItemIndex = -1;

        const langDict = {
            en: { app_desc: "Room Attendant Application", btn_login: "Start Shift", hi: "Hi", credit: "Credit", progress: "Progress", done: "Done", input_room: "New Room Input", daily_act: "Daily Activities", btn_end: "End Shift & Summary", note: "Note", btn_final: "Status 3 (Done)", back: "Back", report_title: "Room Attendant Daily Report", total_credit: "Total Credit", total_done: "Total Done", select_status: "Select Status", cancel: "Cancel", lang_label: "Switch to Indonesia" },
            id: { app_desc: "Aplikasi Room Attendant", btn_login: "Mulai Shift", hi: "Halo", credit: "Kredit", progress: "Progres", done: "Selesai", input_room: "Input Kamar Baru", daily_act: "Aktivitas Harian", btn_end: "Akhiri Shift & Rekap", note: "Catatan", btn_final: "Status 3 (Selesai)", back: "Kembali", report_title: "Laporan Harian Room Attendant", total_credit: "Total Kredit", total_done: "Total Selesai", select_status: "Pilih Status", cancel: "Batal", lang_label: "Ganti ke B.Inggris" }
        };

        window.onload = () => { applyLanguage(); if(currentUser) showDashboard(); };

        function applyLanguage() {
            const d = langDict[currentLang];
            document.querySelectorAll('[data-lang]').forEach(el => el.innerText = d[el.getAttribute('data-lang')]);
            document.getElementById('lang-label').innerText = d.lang_label;
        }

        function switchLanguage() { currentLang = currentLang === 'en' ? 'id' : 'en'; localStorage.setItem('myra_lang', currentLang); applyLanguage(); closeModal(); }

        function login() {
            let n = document.getElementById('username').value;
            if(!n) return alert("Enter Name!");
            currentUser = n; localStorage.setItem('myra_user', n); showDashboard();
        }

        function logout() {
            if(confirm("Logout and RESET all data?")) {
                localStorage.clear(); location.reload();
            }
        }

        function showDashboard() {
            document.getElementById('login-page').classList.add('hidden');
            document.getElementById('dashboard-page').classList.remove('hidden');
            document.getElementById('display-name').innerText = currentUser;
            document.getElementById('act-morning').value = activities.morning;
            document.getElementById('act-afternoon').value = activities.afternoon;
            renderRoomList(); updateStats();
        }

        document.getElementById('act-morning').oninput = (e) => { activities.morning = e.target.value; saveAct(); };
        document.getElementById('act-afternoon').oninput = (e) => { activities.afternoon = e.target.value; saveAct(); };
        function saveAct() { localStorage.setItem('myra_activities', JSON.stringify(activities)); }

        function openStatusModal(type) {
            currentStatusType = type;
            const grid = document.getElementById('status-options');
            grid.innerHTML = "";
            allStatuses.forEach(s => grid.innerHTML += `<button class="grid-btn" onclick="selectStatus('${s}')">${s}</button>`);
            document.getElementById('status-modal').classList.remove('hidden');
        }

        function selectStatus(s) {
            closeModal();
            if(currentStatusType === 'initial') addRoom(s);
            else if(currentStatusType === 'status2') { rooms[currentRoomId].status2 = s; save(); document.getElementById('display-status-2').innerText = s; }
            else if(currentStatusType === 'final') { rooms[currentRoomId].status3 = s; rooms[currentRoomId].isCompleted = true; save(); goBack(); }
        }

        function addRoom(s) {
            let num = document.getElementById('new-room-number').value;
            if(!num) return alert("Enter Room!");
            rooms.push({ number: num, status1: s, status2: "", status3: "", timeIn: "", timeOut: "", items: new Array(itemsList.length).fill(0), note: "", isCompleted: false });
            save(); document.getElementById('new-room-number').value = ""; renderRoomList(); updateStats();
        }

        function renderRoomList() {
            const container = document.getElementById('room-list'); container.innerHTML = "";
            rooms.forEach((r, i) => {
                let st = `<span>${r.status1}</span>` + (r.status2 ? ` > ${r.status2}` : "") + (r.status3 ? ` > <b>${r.status3}</b>` : "");
                container.innerHTML += `<div class="room-card ${r.isCompleted?'completed':''}" onclick="openRoomDetail(${i})"><div><div class="room-number">${r.number}</div><div style="font-size:0.7rem; color:#888">${r.timeIn||'--'} - ${r.timeOut||'--'}</div></div><div class="room-status">${st}</div></div>`;
            });
        }

        function deleteRoom() {
            const roomNum = rooms[currentRoomId].number;
            // Konfirmasi sebelum menghapus
            if (confirm(`Are you sure you want to delete Room ${roomNum}?`)) {
                // Menghapus 1 data dari array berdasarkan index saat ini
                rooms.splice(currentRoomId, 1); 
                
                // Simpan perubahan ke LocalStorage
                save(); 
                
                // Kembali ke Dashboard
                goBack(); 
                
                // Refresh daftar tampilan di Dashboard
                renderRoomList(); 
                updateStats();
            }
        }

        function openRoomDetail(i) {
            currentRoomId = i; let r = rooms[i];
            document.getElementById('dashboard-page').classList.add('hidden');
            document.getElementById('detail-page').classList.remove('hidden');
            document.getElementById('detail-room-number').innerText = "Room " + r.number;
            document.getElementById('detail-status-1').innerText = r.status1;
            document.getElementById('display-status-2').innerText = r.status2 || "Select Status 2";
            document.getElementById('display-time-in').innerText = r.timeIn || "--:--";
            document.getElementById('display-time-out').innerText = r.timeOut || "--:--";
            document.getElementById('room-note').value = r.note;
            const list = document.getElementById('amenities-list'); list.innerHTML = "";
            itemsList.forEach((it, idx) => {
                list.innerHTML += `<div class="item-row" onclick="openQty(${idx})"><span>${it}</span><span class="item-qty">${r.items[idx]||''}</span></div>`;
            });
            document.getElementById('room-note').oninput = (e) => { rooms[currentRoomId].note = e.target.value; save(); };
        }

        function setTime(t) {
            let time = new Date().toLocaleTimeString('id-ID', {hour:'2-digit', minute:'2-digit'});
            if(t==='in') rooms[currentRoomId].timeIn = time; else rooms[currentRoomId].timeOut = time;
            save(); openRoomDetail(currentRoomId);
        }

        function openQty(i) { currentItemIndex = i; document.getElementById('qty-modal').classList.remove('hidden'); }
        function selectQty(q) { rooms[currentRoomId].items[currentItemIndex] = q; save(); closeModal(); openRoomDetail(currentRoomId); }
        function closeModal() { document.querySelectorAll('.modal').forEach(m => m.classList.add('hidden')); }
        function save() { localStorage.setItem('myra_rooms', JSON.stringify(rooms)); }
        function updateStats() {
            document.getElementById('total-credits').innerText = rooms.length;
            document.getElementById('total-done').innerText = rooms.filter(r => r.isCompleted).length;
            document.getElementById('total-progress').innerText = rooms.filter(r => !r.isCompleted).length;
        }

        function goBack() { document.getElementById('detail-page').classList.add('hidden'); showDashboard(); }
        function goBackToDashboard() { document.getElementById('summary-page').classList.add('hidden'); showDashboard(); }

        function showSummary() {
            document.getElementById('dashboard-page').classList.add('hidden');
            document.getElementById('summary-page').classList.remove('hidden');
            document.getElementById('sum-name').innerText = currentUser;
            document.getElementById('sum-date').innerText = new Date().toLocaleDateString();
            document.getElementById('sum-morning').innerText = activities.morning || "-";
            document.getElementById('sum-afternoon').innerText = activities.afternoon || "-";
            const body = document.getElementById('summary-body'); body.innerHTML = "";
            rooms.forEach(r => {
                let used = []; r.items.forEach((q, idx) => { if(q>0) used.push(`${itemsList[idx]}(${q})`); });
                body.innerHTML += `<tr><td>${r.number}</td><td>${r.timeIn}-${r.timeOut}</td><td>${r.status1}>${r.status2}>${r.status3}</td><td>${used.join(', ')}</td></tr>`;
            });
            document.getElementById('sum-credit').innerText = rooms.length;
            document.getElementById('sum-done').innerText = rooms.filter(r => r.isCompleted).length;
        }

        function openUserMenu() { document.getElementById('user-menu-modal').classList.remove('hidden'); }
        function printReport() { window.print(); }
    </script>
    <div class="watermark">Â©jackiy-2026 MyRA v1.0</div>
</body>
</html>
